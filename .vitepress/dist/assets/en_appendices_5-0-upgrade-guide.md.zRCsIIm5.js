import{_ as a,c as s,o as i,ag as n}from"./chunks/framework.DRADY2L-.js";const u=JSON.parse('{"title":"5.0 Upgrade Guide","description":"","frontmatter":{},"headers":[],"relativePath":"en/appendices/5-0-upgrade-guide.md","filePath":"en/appendices/5-0-upgrade-guide.md","lastUpdated":null}'),t={name:"en/appendices/5-0-upgrade-guide.md"};function p(r,e,l,o,d,h){return i(),s("div",null,[...e[0]||(e[0]=[n(`<h1 id="_5-0-upgrade-guide" tabindex="-1">5.0 Upgrade Guide <a class="header-anchor" href="#_5-0-upgrade-guide" aria-label="Permalink to &quot;5.0 Upgrade Guide&quot;">​</a></h1><p>First, check that your application is running on latest CakePHP 4.x version.</p><h2 id="fix-deprecation-warnings" tabindex="-1">Fix Deprecation Warnings <a class="header-anchor" href="#fix-deprecation-warnings" aria-label="Permalink to &quot;Fix Deprecation Warnings&quot;">​</a></h2><p>Once your application is running on latest CakePHP 4.x, enable deprecation warnings in <strong>config/app.php</strong></p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Error&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;errorLevel&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> E_ALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Now that you can see all the warnings, make sure these are fixed before proceeding with the upgrade.</p><p>Some potentially impactful deprecations you should make sure you have addressed are:</p><ul><li><code>Table::query()</code> was deprecated in 4.5.0. Use <code>selectQuery()</code>, <code>updateQuery()</code>, <code>insertQuery()</code> and <code>deleteQuery()</code> instead.</li></ul><h2 id="upgrade-to-php-8-1" tabindex="-1">Upgrade to PHP 8.1 <a class="header-anchor" href="#upgrade-to-php-8-1" aria-label="Permalink to &quot;Upgrade to PHP 8.1&quot;">​</a></h2><p>If you are not running on <strong>PHP 8.1 or higher</strong>, you will need to upgrade PHP before updating CakePHP.</p><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p>CakePHP 5.0 requires <strong>a minimum of PHP 8.1</strong>. <a id="upgrade-tool-use"></a></p></div><h2 id="use-the-upgrade-tool" tabindex="-1">Use the Upgrade Tool <a class="header-anchor" href="#use-the-upgrade-tool" aria-label="Permalink to &quot;Use the Upgrade Tool&quot;">​</a></h2><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p>The upgrade tool only works on applications running on latest CakePHP 4.x. You cannot run the upgrade tool after updating to CakePHP 5.0.</p></div><p>Because CakePHP 5 leverages union types and <code>mixed</code>, there are many backwards incompatible changes concerning method signatures and file renames. To help expedite fixing these tedious changes there is an upgrade CLI tool:</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Install the upgrade tool</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/cakephp/upgrade</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5.x</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">composer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --no-dev</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>With the upgrade tool installed you can now run it on your application or plugin</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin/cake upgrade rector --rules cakephp50 &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">path/to/app/src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin/cake upgrade rector --rules chronos3 &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">path/to/app/src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="update-cakephp-dependency" tabindex="-1">Update CakePHP Dependency <a class="header-anchor" href="#update-cakephp-dependency" aria-label="Permalink to &quot;Update CakePHP Dependency&quot;">​</a></h2><p>After applying rector refactorings you need to upgrade CakePHP, its plugins, PHPUnit and maybe other dependencies in your <code>composer.json</code>. This process heavily depends on your application so we recommend you compare your <code>composer.json</code> with what is present in <a href="https://github.com/cakephp/app/blob/5.x/composer.json" target="_blank" rel="noreferrer">cakephp/app</a>.</p><p>After the version strings are adjusted in your <code>composer.json</code> execute <code>composer update -W</code> and check its output.</p><h2 id="update-app-files-based-upon-latest-app-template" tabindex="-1">Update app files based upon latest app template <a class="header-anchor" href="#update-app-files-based-upon-latest-app-template" aria-label="Permalink to &quot;Update app files based upon latest app template&quot;">​</a></h2><p>Next, ensure the rest of your application has been updated to be based upon the latest version of <a href="https://github.com/cakephp/app/blob/5.x/" target="_blank" rel="noreferrer">cakephp/app</a>.</p>`,22)])])}const k=a(t,[["render",p]]);export{u as __pageData,k as default};
