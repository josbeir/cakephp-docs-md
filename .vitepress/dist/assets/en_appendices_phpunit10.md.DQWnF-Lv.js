import{_ as o,C as s,c as p,o as l,ag as i,G as t,w as h}from"./chunks/framework.DRADY2L-.js";const b=JSON.parse('{"title":"PHPUnit 10 Upgrade","description":"","frontmatter":{},"headers":[],"relativePath":"en/appendices/phpunit10.md","filePath":"en/appendices/phpunit10.md","lastUpdated":null}'),r={name:"en/appendices/phpunit10.md"};function d(c,e,u,k,m,g){const a=s("bootstrap"),n=s("extensions");return l(),p("div",null,[e[0]||(e[0]=i(`<h1 id="phpunit-10-upgrade" tabindex="-1">PHPUnit 10 Upgrade <a class="header-anchor" href="#phpunit-10-upgrade" aria-label="Permalink to &quot;PHPUnit 10 Upgrade&quot;">​</a></h1><p>With CakePHP 5 the minimum PHPUnit version has changed from <code>^8.5 || ^9.3</code> to <code>^10.1</code>. This introduces a few breaking changes from PHPUnit as well as from CakePHP&#39;s side.</p><h2 id="phpunit-xml-adjustments" tabindex="-1">phpunit.xml adjustments <a class="header-anchor" href="#phpunit-xml-adjustments" aria-label="Permalink to &quot;phpunit.xml adjustments&quot;">​</a></h2><p>It is recommended to let PHPUnit update its configuration file via the following command</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>vendor/bin/phpunit --migrate-configuration</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p>Make sure you are already on PHPUnit 10 via <code>vendor/bin/phpunit --version</code> before executing this command!</p></div><p>With this command out of the way your <code>phpunit.xml</code> already has most of the recommended changes present.</p><h3 id="new-event-system" tabindex="-1">New event system <a class="header-anchor" href="#new-event-system" aria-label="Permalink to &quot;New event system&quot;">​</a></h3><p>PHPUnit 10 removed the old hook system and introduced a new <a href="https://docs.phpunit.de/en/10.5/extending-phpunit.html#extending-the-test-runner" target="_blank" rel="noreferrer">Event system</a> which requires the following code in your <code>phpunit.xml</code> to be adjusted from</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">extensions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">extension</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Cake\\TestSuite\\Fixture\\PHPUnitExtension&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">extensions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>to::</p>`,11)),t(n,null,{default:h(()=>[t(a,{class:"Cake\\TestSuite\\Fixture\\Extension\\PHPUnitExtension"})]),_:1}),e[1]||(e[1]=i(`<h2 id="withconsecutive-has-been-removed" tabindex="-1"><code>-&gt;withConsecutive()</code> has been removed <a class="header-anchor" href="#withconsecutive-has-been-removed" aria-label="Permalink to &quot;\`-&gt;withConsecutive()\` has been removed&quot;">​</a></h2><p>You can convert the removed <code>-&gt;withConsecutive()</code> method to a working interim solution like you can see here</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">withConsecutive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;firstCallArg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;secondCallArg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>should be converted to::</p><pre><code>-&gt;with(
    ...self::withConsecutive([&#39;firstCallArg&#39;], [&#39;secondCallArg&#39;])
)
</code></pre><p>the static <code>self::withConsecutive()</code> method has been added via the <code>Cake\\TestSuite\\PHPUnitConsecutiveTrait</code> to the base <code>Cake\\TestSuite\\TestCase</code> class so you don&#39;t have to manually add that trait to your Testcase classes.</p><h2 id="data-providers-have-to-be-static" tabindex="-1">data providers have to be static <a class="header-anchor" href="#data-providers-have-to-be-static" aria-label="Permalink to &quot;data providers have to be static&quot;">​</a></h2><p>If your testcases leverage the data provider feature of PHPUnit then you have to adjust your data providers to be static</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> myProvider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> array</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>should be converted to::</p><pre><code>public static function myProvider(): array
</code></pre>`,11))])}const y=o(r,[["render",d]]);export{b as __pageData,y as default};
